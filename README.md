
# Challenge 4: Building a Regression Model for Marketing

**Student**: Alexandre Rodrigues da Silva Filho

## Overview

This repository contains the code developed for Challenge 4 of the Marketing course, aimed at building and evaluating a linear regression model to predict sales based on spending across different marketing channels. The code was automatically generated by Google Colab and can be accessed [here](https://colab.research.google.com/drive/12S0M-IxWUy5nYVc7vjd7UYk5TmyXEVcl).

## Repository Contents

1. **Data Import**
2. **Data Exploration and Visualisation**
3. **Data Preparation**
4. **Model Training and Evaluation**
5. **Prediction**

## Instructions

### 1. Data Import

The first step is to import the dataset required for the challenge. The `MKT.csv` file needs to be uploaded for analysis. Use the following code to load the file:

```python
from google.colab import files
upload = files.upload()
```

### 2. Data Exploration and Visualisation

After importing, the necessary libraries are imported and the DataFrame is created:

```python
import pandas as pd
import numpy as np

df = pd.read_csv('MKT.csv')
df.info()
df.describe()
```

For visual analysis, the following actions are performed:

- **Sales Box Plot**

  ```python
  import plotly.express as px
  fig = px.box(df, x="sales")
  fig.update_traces(line_color='blue')
  fig.update_layout(title_text='Sales Box Plot')
  fig.show()
  ```

- **Pair Plot of Variables**

  ```python
  import seaborn as sns
  sns.pairplot(df)
  ```

- **Pair Plot of Sales vs. Marketing Channels**

  ```python
  sns.pairplot(df, x_vars=['sales'], y_vars=['youtube','facebook','newspaper'])
  ```

- **Correlation Heatmap**

  ```python
  sns.heatmap(df.corr(), annot=True)
  ```

### 3. Data Preparation

Separate the explanatory variables (`x`) from the response variable (`y`):

```python
x = df[['youtube','facebook','newspaper']]
y = df[['sales']]
```

Split the data into training and test sets:

```python
from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, train_size = 0.7, random_state=42)
```

### 4. Model Training and Evaluation

Train the linear regression model and evaluate its performance:

```python
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score

ln = LinearRegression()
ln.fit(x_train, y_train)
y_pred = ln.predict(x_test)

r = r2_score(y_test, y_pred)
print(f'R² Score: {r}')
```

To visualise the model’s accuracy:

```python
import matplotlib.pyplot as plt

c = [i for i in range(1, len(y_test)+1)]
plt.plot(c, y_test, color="blue", label="Real Data")
plt.plot(c, y_pred, color="green", label="Predicted Data")
plt.xlabel("Data")
plt.ylabel("Sales")
plt.legend()
plt.show()
```

### 5. Prediction

Make a prediction with specific input values:

```python
youtube = 250
facebook = 0
newspaper = 0

input = [[youtube, facebook, newspaper]]
predicted_sales = ln.predict(input)
print(f'Predicted Sales: {predicted_sales[0][0]}')
```

## Requirements

- Python 3.x
- Libraries: `pandas`, `numpy`, `plotly`, `seaborn`, `sklearn`, `matplotlib`

## Conclusion

This code provides a comprehensive approach to building and evaluating a linear regression model, from data import and exploration to model training and evaluation. Feel free to modify and expand as needed to accommodate different marketing scenarios.
